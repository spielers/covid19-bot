{"remainingRequest":"E:\\hackathon\\jhu-covid19bot-web-master\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!E:\\hackathon\\jhu-covid19bot-web-master\\src\\Components\\Parts\\ChatInput.vue?vue&type=script&lang=js&","dependencies":[{"path":"E:\\hackathon\\jhu-covid19bot-web-master\\src\\Components\\Parts\\ChatInput.vue","mtime":1587562930000},{"path":"E:\\hackathon\\jhu-covid19bot-web-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\hackathon\\jhu-covid19bot-web-master\\node_modules\\babel-loader\\lib\\index.js","mtime":499162500000},{"path":"E:\\hackathon\\jhu-covid19bot-web-master\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"E:\\hackathon\\jhu-covid19bot-web-master\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCBBdWRpb1JlY29yZGVyIGZyb20gJ2F1ZGlvLXJlY29yZGVyLXBvbHlmaWxsJwppbXBvcnQgKiBhcyBoYXJrIGZyb20gJ2hhcmsnCndpbmRvdy5NZWRpYVJlY29yZGVyID0gQXVkaW9SZWNvcmRlcgoKZXhwb3J0IGRlZmF1bHQgewogICAgbmFtZTogJ0NoYXRJbnB1dCcsCiAgICBkYXRhKCl7CiAgICAgICAgcmV0dXJuIHsKICAgICAgICAgICAgcXVlcnk6ICcnLAogICAgICAgICAgICBtaWNyb3Bob25lOiBmYWxzZSwKICAgICAgICAgICAgcmVjb2duaXRpb246IG51bGwsCiAgICAgICAgICAgIHJlY29yZGVyOiBudWxsLAogICAgICAgICAgICBzaG91bGRfbGlzdGVuOiBmYWxzZQogICAgICAgIH0KICAgIH0sCiAgICBjb21wdXRlZDogewogICAgICAgIG1pY3JvcGhvbmVfc3VwcG9ydGVkKCl7CiAgICAgICAgICAgIHJldHVybiB3aW5kb3cud2Via2l0U3BlZWNoUmVjb2duaXRpb24gfHwgd2luZG93LlNwZWVjaFJlY29nbml0aW9uIHx8ICF3aW5kb3cuTWVkaWFSZWNvcmRlci5ub3RTdXBwb3J0ZWQKICAgICAgICB9CiAgICB9LAogICAgd2F0Y2g6IHsKICAgICAgICAvKiBUb2dnbGUgbWljcm9waG9uZSAqLwogICAgICAgIG1pY3JvcGhvbmUoYWN0aXZhdGUpewogICAgICAgICAgICBpZiAoYWN0aXZhdGUpewogICAgICAgICAgICAgICAgdGhpcy5zaG91bGRfbGlzdGVuID0gdHJ1ZQogICAgICAgICAgICAgICAgaWYgKHdpbmRvdy53ZWJraXRTcGVlY2hSZWNvZ25pdGlvbiB8fCB3aW5kb3cuU3BlZWNoUmVjb2duaXRpb24pewogICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb2duaXRpb24gPSBuZXcgd2luZG93LndlYmtpdFNwZWVjaFJlY29nbml0aW9uKCkgfHwgbmV3IHdpbmRvdy5TcGVlY2hSZWNvZ25pdGlvbigpCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvZ25pdGlvbi5pbnRlcmltUmVzdWx0cyA9IHRydWUKICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29nbml0aW9uLmxhbmcgPSB0aGlzLmxhbmcoKQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb2duaXRpb24ub25yZXN1bHQgPSBldmVudCA9PiB7CiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAobGV0IGkgPSBldmVudC5yZXN1bHRJbmRleDsgaSA8IGV2ZW50LnJlc3VsdHMubGVuZ3RoOyArK2kpewogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5xdWVyeSA9IGV2ZW50LnJlc3VsdHNbaV1bMF0udHJhbnNjcmlwdCAvLyA8LSBwdXNoIHJlc3VsdHMgdG8gdGhlIFRleHQgaW5wdXQKICAgICAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29nbml0aW9uLm9uZW5kID0gKCkgPT4gewogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnJlY29nbml0aW9uLnN0b3AoKQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLm1pY3JvcGhvbmUgPSBmYWxzZQogICAgICAgICAgICAgICAgICAgICAgICB0aGlzLnN1Ym1pdCh7dGV4dDogdGhpcy5xdWVyeX0pIC8vIDwtIHN1Ym1pdCB0aGUgcmVzdWx0CiAgICAgICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb2duaXRpb24ub25lcnJvciA9ICgpID0+IHRoaXMubWljcm9waG9uZSA9IGZhbHNlCiAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvZ25pdGlvbi5zdGFydCgpCiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICBlbHNlIGlmICh3aW5kb3cuTWVkaWFSZWNvcmRlcil7CiAgICAgICAgICAgICAgICAgICAgaWYgKHdpbmRvdy5NZWRpYVJlY29yZGVyKXsKICAgICAgICAgICAgICAgICAgICAgICAgbmF2aWdhdG9yLm1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEoe2F1ZGlvOiB0cnVlfSkKICAgICAgICAgICAgICAgICAgICAgICAgLnRoZW4oc3RyZWFtID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMucmVjb3JkZXIgPSBuZXcgd2luZG93Lk1lZGlhUmVjb3JkZXIoc3RyZWFtKQogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvcmRlci5hZGRFdmVudExpc3RlbmVyKCdkYXRhYXZhaWxhYmxlJywgcmVjb3JkaW5nID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICBjb25zdCByZWFkZXIgPSBuZXcgRmlsZVJlYWRlcigpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZGVyLnJlYWRBc0RhdGFVUkwocmVjb3JkaW5nLmRhdGEpCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgcmVhZGVyLm9ubG9hZGVuZCA9ICgpID0+IHsKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5zdWJtaXQoe2F1ZGlvOiByZWFkZXIucmVzdWx0LnJlcGxhY2UoL15kYXRhOi4rO2Jhc2U2NCwvLCAnJyl9KQogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0KICAgICAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgICAgICBoYXJrKHRoaXMucmVjb3JkZXIuc3RyZWFtKS5vbignc3RvcHBlZF9zcGVha2luZycsICgpID0+IHRoaXMubWljcm9waG9uZSA9IGZhbHNlKSAvLyA8LSBTcGVlY2ggZW5kIGRldGVjdGlvbgogICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5yZWNvcmRlci5zdGFydCgpCiAgICAgICAgICAgICAgICAgICAgICAgIH0pCiAgICAgICAgICAgICAgICAgICAgICAgIC5jYXRjaCgoKSA9PiB0aGlzLm1pY3JvcGhvbmUgPSBmYWxzZSkKICAgICAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVsc2UgaWYgKHRoaXMucmVjb2duaXRpb24pIHRoaXMucmVjb2duaXRpb24uYWJvcnQoKQogICAgICAgICAgICBlbHNlIGlmICh0aGlzLnJlY29yZGVyKSB0aGlzLnJlY29yZGVyLnN0b3AoKQogICAgICAgIH0KICAgIH0sCiAgICBtZXRob2RzOiB7CiAgICAgICAgbGlzdGVuKCl7CiAgICAgICAgICAgIGlmICh0aGlzLnNob3VsZF9saXN0ZW4pIHRoaXMubWljcm9waG9uZSA9IHRydWUKICAgICAgICB9LAogICAgICAgIHN1Ym1pdChzdWJtaXNzaW9uKXsKICAgICAgICAgICAgaWYgKHN1Ym1pc3Npb24udGV4dCAmJiBzdWJtaXNzaW9uLnRleHQubGVuZ3RoID4gMCl7CiAgICAgICAgICAgICAgICB0aGlzLiRlbWl0KCdzdWJtaXQnLCBzdWJtaXNzaW9uKQogICAgICAgICAgICAgICAgdGhpcy5xdWVyeSA9ICcnCiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIGVsc2UgaWYgKHN1Ym1pc3Npb24uYXVkaW8pIHRoaXMuJGVtaXQoJ3N1Ym1pdCcsIHN1Ym1pc3Npb24pCiAgICAgICAgfQogICAgfQp9Cg=="},{"version":3,"sources":["ChatInput.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAsGA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA","file":"ChatInput.vue","sourceRoot":"src/Components/Parts","sourcesContent":["<template>\n    <div class=\"bottomchat\">\n        <div class=\"container\">\n            <!-- Here are the suggestions -->\n            <div class=\"suggestions\"><slot /></div>\n            <div class=\"flexible\">\n                <!-- Text input -->\n                <input\n                    v-model=\"query\"\n                    class=\"input\"\n                    type=\"text\"\n                    autofocus\n                    :placeholder=\"(translations[lang()] && translations[lang()].inputTitle) || translations[config.fallback_lang].inputTitle\"\n                    :aria-label=\"(translations[lang()] && translations[lang()].inputTitle) || translations[config.fallback_lang].inputTitle\"\n                    @keypress.enter=\"submit({text: query})\"\n                    @focus=\"microphone = false; should_listen = false\">\n\n                <!-- Send message button (arrow button) -->\n                <button\n                    v-if=\"!microphone && query.length > 0 || !microphone_supported\"\n                    class=\"button\"\n                    :title=\"(translations[lang()] && translations[lang()].sendTitle) || translations[config.fallback_lang].sendTitle\"\n                    :aria-label=\"(translations[lang()] && translations[lang()].sendTitle) || translations[config.fallback_lang].sendTitle\"\n                    @click=\"submit({text: query})\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">arrow_upward</i>\n                </button>\n\n                <!-- Microphone Button -->\n                <button\n                    v-else\n                    class=\"button\"\n                    :aria-label=\"(translations[lang()] && translations[lang()].microphoneTitle) || translations[config.fallback_lang].microphoneTitle\"\n                    :title=\"(translations[lang()] && translations[lang()].microphoneTitle) || translations[config.fallback_lang].microphoneTitle\"\n                    :class=\"{'mic_active': microphone}\"\n                    @click=\"microphone = !microphone\">\n                    <i class=\"material-icons\" aria-hidden=\"true\">mic</i>\n                </button>\n            </div>\n        </div>\n    </div>\n</template>\n\n<style lang=\"sass\" scoped>\n@import '@/Style/Mixins'\n\n.bottomchat\n    position: fixed\n    bottom: 0\n    left: 0\n    width: 100%\n    background-color: var(--background)\n    padding-bottom: 8px\n\n.flexible\n    display: flex\n\n.suggestions\n    overflow-x: scroll\n    overflow-y: hidden\n    white-space: nowrap\n    -webkit-overflow-scrolling: touch\n\n    &::-webkit-scrollbar\n        display: none\n\n.input\n    margin-left: 5px\n    font-size: 16px\n    font-weight: 500\n    width: 100%\n    box-sizing: border-box\n    border: none\n    padding: 10px 12px\n    color: var(--text)\n    border-radius: 40px\n    flex: 1 0 0\n    background-color: var(--element-background)\n\n    &:focus\n        outline: 0 !important\n\n.button\n    @include reset\n    padding: 8px\n    margin-left: 6px\n    margin-right: 5px\n    border-radius: 50%\n    cursor: pointer\n    background-color: var(--element-background)\n    color: var(--text)\n    font-size: 24px\n    display: flex\n\n    &:focus\n        outline: 0 !important\n\n    &.mic_active\n        background-color: #F44336\n        color: white\n</style>\n\n<script>\nimport AudioRecorder from 'audio-recorder-polyfill'\nimport * as hark from 'hark'\nwindow.MediaRecorder = AudioRecorder\n\nexport default {\n    name: 'ChatInput',\n    data(){\n        return {\n            query: '',\n            microphone: false,\n            recognition: null,\n            recorder: null,\n            should_listen: false\n        }\n    },\n    computed: {\n        microphone_supported(){\n            return window.webkitSpeechRecognition || window.SpeechRecognition || !window.MediaRecorder.notSupported\n        }\n    },\n    watch: {\n        /* Toggle microphone */\n        microphone(activate){\n            if (activate){\n                this.should_listen = true\n                if (window.webkitSpeechRecognition || window.SpeechRecognition){\n                    this.recognition = new window.webkitSpeechRecognition() || new window.SpeechRecognition()\n                    this.recognition.interimResults = true\n                    this.recognition.lang = this.lang()\n                    this.recognition.onresult = event => {\n                        for (let i = event.resultIndex; i < event.results.length; ++i){\n                            this.query = event.results[i][0].transcript // <- push results to the Text input\n                        }\n                    }\n                    this.recognition.onend = () => {\n                        this.recognition.stop()\n                        this.microphone = false\n                        this.submit({text: this.query}) // <- submit the result\n                    }\n                    this.recognition.onerror = () => this.microphone = false\n                    this.recognition.start()\n                }\n                else if (window.MediaRecorder){\n                    if (window.MediaRecorder){\n                        navigator.mediaDevices.getUserMedia({audio: true})\n                        .then(stream => {\n                            this.recorder = new window.MediaRecorder(stream)\n                            this.recorder.addEventListener('dataavailable', recording => {\n                                const reader = new FileReader()\n                                reader.readAsDataURL(recording.data)\n                                reader.onloadend = () => {\n                                    this.submit({audio: reader.result.replace(/^data:.+;base64,/, '')})\n                                }\n                            })\n                            hark(this.recorder.stream).on('stopped_speaking', () => this.microphone = false) // <- Speech end detection\n                            this.recorder.start()\n                        })\n                        .catch(() => this.microphone = false)\n                    }\n                }\n            }\n\n            else if (this.recognition) this.recognition.abort()\n            else if (this.recorder) this.recorder.stop()\n        }\n    },\n    methods: {\n        listen(){\n            if (this.should_listen) this.microphone = true\n        },\n        submit(submission){\n            if (submission.text && submission.text.length > 0){\n                this.$emit('submit', submission)\n                this.query = ''\n            }\n\n            else if (submission.audio) this.$emit('submit', submission)\n        }\n    }\n}\n</script>"]}]}